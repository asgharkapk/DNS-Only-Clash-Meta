[custom]

; ===============================
; 🔹 Rulesets
; ===============================

# --- Iran Websites ---
ruleset=🇮🇷IranWebsites,[]GEOIP,IR
ruleset=🇮🇷IranWebsites,[]GEOSITE,category-ir
ruleset=🇮🇷IranWebsites,[]RULE-SET,apps
ruleset=🇮🇷IranWebsites,[]RULE-SET,category_ir
ruleset=🇮🇷IranWebsites,[]RULE-SET,iran
ruleset=🇮🇷IranWebsites,[]RULE-SET,ir
ruleset=🇮🇷IranWebsites,[]RULE-SET,ircidr
ruleset=🇮🇷IranWebsites,[]RULE-SET,irasn
ruleset=🇮🇷IranWebsites,[]RULE-SET,arvancloud
ruleset=🇮🇷IranWebsites,[]RULE-SET,derakcloud
ruleset=🇮🇷IranWebsites,[]RULE-SET,iranserver
ruleset=🇮🇷IranWebsites,[]RULE-SET,parspack

# --- LAN / Private ---
ruleset=🖥️Lan,[]GEOSITE,private

ruleset=🖥️Lan,[]RULE-SET,C4Uprivate
ruleset=🖥️Lan,[]RULE-SET,private

;ruleset=🖥️Lan,[]GEOIP,private ;Android apps can't access proxy
;ruleset=🖥️Lan,[]GEOIP,LAN ;Android apps can't access proxy

# --- Trackers / Security / Ads ---
ruleset=🛡️PrivacyTrackers,[]RULE-SET,BanEasyPrivacy

ruleset=🛑Advertisements,[]GEOSITE,category-ads-all
ruleset=🛑Advertisements,[]RULE-SET,ACLBanAD
ruleset=🛑Advertisements,[]RULE-SET,ACLBanEasyList
ruleset=🛑Advertisements,[]RULE-SET,BanEasyListChina
ruleset=🛑Advertisements,[]RULE-SET,IranAds
ruleset=🛑Advertisements,[]RULE-SET,spotifyads
ruleset=🛑Advertisements,[]RULE-SET,BanProgramAD
ruleset=🛑Advertisements,[]RULE-SET,BanAD
ruleset=🛑Advertisements,[]RULE-SET,PrivateTracker
ruleset=🛑Advertisements,[]RULE-SET,category_public_tracker
ruleset=🛑Advertisements,[]RULE-SET,LiteAds
ruleset=🛑Advertisements,[]RULE-SET,iran_ads
ruleset=🛑Advertisements,[]RULE-SET,PersianBlocker
ruleset=🛑Advertisements,[]RULE-SET,ads
ruleset=🛑Advertisements,[]RULE-SET,BanEasyList
ruleset=🛑Advertisements,[]RULE-SET,xiaomi-ads
ruleset=🛑Advertisements,[]RULE-SET,xiaomi_block_list

ruleset=🦠SECURITY,[]RULE-SET,malware
ruleset=🦠SECURITY,[]RULE-SET,cryptominers
ruleset=🦠SECURITY,[]RULE-SET,phishing
ruleset=🦠SECURITY,[]RULE-SET,warninglist
ruleset=🦠SECURITY,[]RULE-SET,Ponzi

# --- Apps & Services ---
ruleset=🎛NVIDIA🎯,[]GEOSITE,nvidia

ruleset=</>GIT🎯,[]GEOSITE,github
ruleset=</>GIT🎯,[]GEOSITE,gitlab
ruleset=</>GIT🎯,[]RULE-SET,github

ruleset=📺YouTube🎯,[]RULE-SET,ACLyoutube
ruleset=📺YouTube🎯,[]RULE-SET,youtube
ruleset=📺YouTube🎯,[]RULE-SET,YouTubeMusic
ruleset=📺YouTube🎯,[]RULE-SET,10iumYouTube

ruleset=📱Google🎯,[]GEOSITE,google
ruleset=📱Google🎯,[]PROCESS-NAME,com.android.vending
ruleset=📱Google🎯,[]PROCESS-NAME,com.google.android.gms
ruleset=📱Google🎯,[]RULE-SET,ACLgoogle
ruleset=📱Google🎯,[]RULE-SET,google
ruleset=📱Google🎯,[]RULE-SET,google-play

ruleset=📙Reddit🎯,[]RULE-SET,reddit

ruleset=🔵Telegram🎯,[]PROCESS-NAME,Telegram.exe
ruleset=🔵Telegram🎯,[]PROCESS-NAME,org.telegram.messenger
ruleset=🔵Telegram🎯,[]PROCESS-NAME,org.telegram.messenger.web
ruleset=🔵Telegram🎯,[]RULE-SET,ACLtelegram
ruleset=🔵Telegram🎯,[]RULE-SET,telegram

ruleset=🤖OpenAI🎯,[]GEOSITE,openai
ruleset=🤖OpenAI🎯,[]RULE-SET,openai

ruleset=🐦Twitter🎯,[]PROCESS-NAME,Twitter.exe
ruleset=🐦Twitter🎯,[]PROCESS-NAME,com.twitter.android
ruleset=🐦Twitter🎯,[]RULE-SET,ACLTwitter
ruleset=🐦Twitter🎯,[]RULE-SET,C4Utwitter
ruleset=🐦Twitter🎯,[]RULE-SET,mihTwitter
ruleset=🐦Twitter🎯,[]RULE-SET,Domtwitter

ruleset=🤖Grok🎯,[]DOMAIN-SUFFIX,grok.com
ruleset=🤖Grok🎯,[]DOMAIN-SUFFIX,x.ai

ruleset=🗨️Discord🎯,[]RULE-SET,ACLdiscord
ruleset=🗨️Discord🎯,[]GEOSITE,discord
ruleset=🗨️Discord🎯,[]RULE-SET,discord

ruleset=🎮Steam🎯,[]RULE-SET,ACLsteam
ruleset=🎮Steam🎯,[]RULE-SET,steam
ruleset=🎮Steam🎯,[]RULE-SET,SteamRegionCheck

ruleset=👾Twitch🎯,[]RULE-SET,ACLtwitch
ruleset=👾Twitch🎯,[]RULE-SET,twitch

ruleset=☁️Cloudflare🎯,[]GEOSITE,cloudflare
ruleset=☁️Cloudflare🎯,[]RULE-SET,cloudflare

ruleset=📸Instagram🎯,[]PROCESS-NAME,com.instagram.android
ruleset=📸Instagram🎯,[]RULE-SET,ACLinsta
ruleset=📸Instagram🎯,[]GEOSITE,instagram
ruleset=📸Instagram🎯,[]RULE-SET,instagram

ruleset=📘Facebook🎯,[]GEOSITE,facebook
ruleset=📘Facebook🎯,[]RULE-SET,facebook

ruleset=🎥Netflix🎯,[]GEOSITE,netflix
ruleset=🎥Netflix🎯,[]RULE-SET,Netflix
ruleset=🎥Netflix🎯,[]RULE-SET,NetflixIP

ruleset=🎶Spotify🎯,[]PROCESS-NAME,com.spotify.music
ruleset=🎶Spotify🎯,[]PROCESS-NAME,Spotify.exe
ruleset=🎶Spotify🎯,[]RULE-SET,ACLSpotify
ruleset=🎶Spotify🎯,[]RULE-SET,DomainSpotify
ruleset=🎶Spotify🎯,[]RULE-SET,mihspotify

ruleset=🎬TikTok🎯,[]RULE-SET,TikTok

ruleset=💼LinkedIn🎯,[]GEOSITE,linkedin

ruleset=🎮Dota2🎯,[]PROCESS-NAME,dota2.exe
ruleset=🎮Dota2🎯,[]RULE-SET,Dota2
ruleset=🎮Dota2🎯,https://raw.githubusercontent.com/asgharkapk/ACL4SSR/refs/heads/master/Clash/Dota2.list

# rules coming from rule providers in EN-IR-COUNTRY2.yml
ruleset=📥Download🎯,[]RULE-SET,DownloadManagers
ruleset=📥Download🎯,[]RULE-SET,Download

ruleset=🤖AI🎯,[]RULE-SET,category-ai
ruleset=🤖AI🎯,[]DOMAIN-SUFFIX,deepseek.com
ruleset=🤖AI🎯,[]DOMAIN-SUFFIX,qwen.ai

ruleset=🤬censorMovie🎯,[]RULE-SET,censor

# rules coming from rule providers in EN-IR-COUNTRY2.yml
ruleset=💻AnyDesk🎯,[]PROCESS-NAME,com.anydesk.anydeskandroid
ruleset=💻AnyDesk🎯,[]PROCESS-NAME,AnyDesk.exe
ruleset=💻AnyDesk🎯,[]DOMAIN-SUFFIX,anydesk.com

ruleset=🕹️VideoGame🎯,[]RULE-SET,game
ruleset=🕹️VideoGame🎯,[]RULE-SET,category-games
ruleset=🕹️VideoGame🎯,[]RULE-SET,GameDownload
ruleset=🕹️VideoGame🎯,[]RULE-SET,Xbox

ruleset=📲Xiaomi🎯,[]RULE-SET,xiaomi_white_list

ruleset=💬Whatsapp🎯,[]RULE-SET,whatsapp
ruleset=💬Whatsapp🎯,[]PROCESS-NAME,com.whatsapp
ruleset=💬Whatsapp🎯,[]PROCESS-NAME,WhatsApp.exe

ruleset=🪟Windows🎯,[]RULE-SET,windows

ruleset=🎦Streamer🎯,[]PROCESS-NAME,obs64.exe
ruleset=🎦Streamer🎯,[]PROCESS-NAME,obs-browser-page.exe

# --- Final Rule ---
ruleset=⚡Online,[]FINAL

; ===============================
; 🔹 Group Hierarchy Explanation
; ===============================
; All internet traffic starts at ⚡Online.
; From ⚡Online you can choose:
;   - 🌐Connection → routes via proxies (Manual, Regional, Tests…)
;   - 🔓Direct → bypass proxy (except destination overrides)
;   - 🚫Block → deny traffic
;   - 🎯Destinations → per-service rules (e.g., YouTube, Telegram)
;
; 📝 Notes:
; - If ⚡Online → 🔓Direct, everything except "Destination Groups" goes directly.
; - To use regional proxies, select the country inside 🏁Countries, then select 🏁Countries inside 🌐Connection, and finally 🌐Connection inside ⚡Online.
; - Each "Destination Group" (apps, services, ads, etc.) lets you override the main setting.

; ===============================
; 🔹 Proxy Selection Groups
; ===============================

custom_proxy_group=🌐Connection`select`[]🔓Direct`[]🚫Block

; ===============================
; 🔹 LAN / Region / Rule-based
; ===============================
custom_proxy_group=📘Facebook🎯`select`[]🚫Block`[]🔓Direct`[]🌐Connection
custom_proxy_group=🛑Advertisements`select`[]🚫Block`[]🔓Direct`[]🌐Connection
custom_proxy_group=🛡️PrivacyTrackers`select`[]🚫Block`[]🔓Direct`[]🌐Connection
custom_proxy_group=🦠SECURITY`select`[]🚫Block`[]🔓Direct`[]🌐Connection

custom_proxy_group=🖥️Lan`select`[]🔓Direct`[]🌐Connection`[]🚫Block
custom_proxy_group=🇮🇷IranWebsites`select`[]🔓Direct`[]🌐Connection`[]🚫Block
custom_proxy_group=</>GIT🎯`select`[]🔓Direct`[]🌐Connection`[]🚫Block
custom_proxy_group=🎮Dota2🎯`select`[]🔓Direct`[]🌐Connection`[]🚫Block
custom_proxy_group=🎮Steam🎯`select`[]🔓Direct`[]🌐Connection`[]🚫Block
custom_proxy_group=🤬censorMovie🎯`select`[]🔓Direct`[]🌐Connection`[]🚫Block
custom_proxy_group=🕹️VideoGame🎯`select`[]🔓Direct`[]🌐Connection`[]🚫Block
custom_proxy_group=📲Xiaomi🎯`select`[]🔓Direct`[]🌐Connection`[]🚫Block
custom_proxy_group=🪟Windows🎯`select`[]🔓Direct`[]🌐Connection`[]🚫Block
custom_proxy_group=📥Download🎯`select`[]🔓Direct`[]🌐Connection`[]🚫Block
custom_proxy_group=💻AnyDesk🎯`select`[]🔓Direct`[]🌐Connection`[]🚫Block
custom_proxy_group=💬Whatsapp🎯`select`[]🔓Direct`[]🌐Connection`[]🚫Block

; ===============================
; 🔹 Service & App Destinations
; ===============================

custom_proxy_group=🎛NVIDIA🎯`select`[]🌐Connection`[]🔓Direct`[]🚫Block
custom_proxy_group=📺YouTube🎯`select`[]🌐Connection`[]🔓Direct`[]🚫Block
custom_proxy_group=📱Google🎯`select`[]🌐Connection`[]🔓Direct`[]🚫Block
custom_proxy_group=📙Reddit🎯`select`[]🌐Connection`[]🔓Direct`[]🚫Block
custom_proxy_group=🔵Telegram🎯`select`[]🌐Connection`[]🔓Direct`[]🚫Block
custom_proxy_group=🤖OpenAI🎯`select`[]🌐Connection`[]🔓Direct`[]🚫Block
custom_proxy_group=🐦Twitter🎯`select`[]🌐Connection`[]🔓Direct`[]🚫Block
custom_proxy_group=🤖Grok🎯`select`[]🌐Connection`[]🔓Direct`[]🚫Block
custom_proxy_group=🗨️Discord🎯`select`[]🌐Connection`[]🔓Direct`[]🚫Block
custom_proxy_group=👾Twitch🎯`select`[]🌐Connection`[]🔓Direct`[]🚫Block
custom_proxy_group=☁️Cloudflare🎯`select`[]🌐Connection`[]🔓Direct`[]🚫Block
custom_proxy_group=📸Instagram🎯`select`[]🌐Connection`[]🔓Direct`[]🚫Block
custom_proxy_group=🎥Netflix🎯`select`[]🌐Connection`[]🔓Direct`[]🚫Block
custom_proxy_group=🎶Spotify🎯`select`[]🌐Connection`[]🔓Direct`[]🚫Block
custom_proxy_group=🎬TikTok🎯`select`[]🌐Connection`[]🔓Direct`[]🚫Block
custom_proxy_group=💼LinkedIn🎯`select`[]🌐Connection`[]🔓Direct`[]🚫Block
custom_proxy_group=🤖AI🎯`select`[]🌐Connection`[]🔓Direct`[]🚫Block
custom_proxy_group=🎦Streamer🎯`select`[]🌐Connection`[]🔓Direct`[]🚫Block

; ===============================
; 🔹 Destinations Wrapper
; ===============================

custom_proxy_group=🎯Destinations`select`[]🖥️Lan`[]🇮🇷IranWebsites`[]🛑Advertisements`[]🛡️PrivacyTrackers`[]🦠SECURITY`[]</>GIT🎯`[]🎮Dota2🎯`[]🎮Steam🎯`[]📘Facebook🎯`[]🎛NVIDIA🎯`[]📺YouTube🎯`[]📱Google🎯`[]📙Reddit🎯`[]🔵Telegram🎯`[]🤖OpenAI🎯`[]🐦Twitter🎯`[]🤖Grok🎯`[]🗨️Discord🎯`[]👾Twitch🎯`[]☁️Cloudflare🎯`[]📸Instagram🎯`[]🎥Netflix🎯`[]🎶Spotify🎯`[]🎬TikTok🎯`[]💼LinkedIn🎯`[]📥Download🎯`[]💻AnyDesk🎯`[]🤖AI🎯`[]💬Whatsapp🎯`[]🤬censorMovie🎯`[]🕹️VideoGame🎯`[]📲Xiaomi🎯`[]🪟Windows🎯`[]🎦Streamer🎯


; ===============================
; 🔹 Final Routing Group
; ===============================

custom_proxy_group=🔓Direct`select`[]DIRECT
custom_proxy_group=🚫Block`select`[]REJECT

custom_proxy_group=⚡Online`select`[]🌐Connection`[]🎯Destinations

; ===============================
; 🔹 Generator Flags
; ===============================

enable_rule_generator=true
overwrite_original_rules=true
clash_rule_base=https://raw.githubusercontent.com/asgharkapk/DNS-Only-Clash-Meta/refs/heads/main/clash_rule_base.yml

; ==================================================
; Groups Map (Hierarchy of Traffic Flow & Selection)
; ==================================================
; Traffic (Internet) → Rulesets → Destination Groups → 🌐Connection (which includes all proxy sources)
;
; └── [FINAL]
;     └── ⚡Online [select] (Main entry point for all traffic)
;         ├── 🌐Connection [select] (All proxy options)
;         │   ├── 🔓Direct [select: DIRECT] (Bypass proxy completely)
;         │   └── 🚫Block [select: REJECT] (Block traffic)
;         ├── 🖥️Lan [select] → 🔓Direct / 🌐Connection / 🚫Block
;         ├── 🇮🇷IranWebsites [select] → 🔓Direct / 🌐Connection / 🚫Block
;         ├── 🛑Advertisements [select] → 🔓Direct / 🌐Connection / 🚫Block
;         ├── 🛡️PrivacyTrackers [select] → 🔓Direct / 🌐Connection / 🚫Block
;         └── 🎯App-Specific Destinations (per-service control)
;             ├── 📺YouTube🎯
;             ├── 📱Google🎯
;             ├── 📙Reddit🎯
;             ├── 🔵Telegram🎯
;             ├── 🤖OpenAI🎯
;             ├── 🐦Twitter🎯
;             ├── 🤖Grok🎯
;             ├── 🗨️Discord🎯
;             ├── 🎮Steam🎯
;             ├── 🎮Dota2🎯
;             ├── 👾Twitch🎯
;             ├── ☁️Cloudflare🎯
;             ├── 📷Instagram🎯
;             ├── 📘Facebook🎯
;             ├── 🎥Netflix🎯
;             ├── 🎶Spotify🎯
;             ├── 🎬TikTok🎯
;             ├── 🎛NVIDIA🎯
;             ├── </>GIT🎯
;             └── 💼LinkedIn🎯
;             (Each → 🔓Direct / 🌐Connection / 🚫Block)
